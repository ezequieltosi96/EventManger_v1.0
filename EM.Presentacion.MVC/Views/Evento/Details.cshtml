@model EM.Presentacion.MVC.Models.Evento.EventoViewModel
@{
    ViewData["Title"] = "Detalle Evento";
    Layout = "_LayoutAdmin";
}

<h1 class="text-center">@ViewData["Title"]</h1>

<div class="row">
    <div class="col-md-4 col-md-offset-4">
        <dl class="dl-horizontal">
            <dt>Organiza</dt>
            <dd>@Model.Empresa.RazonSocial</dd>
            <br />
            <dt>@Html.DisplayNameFor(model => model.Nombre)</dt>
            <dd>@Model.Nombre</dd>
            <dt>@Html.DisplayNameFor(model => model.Descripcion)</dt>
            <dd>@Model.Descripcion</dd>
            <dt>@Html.DisplayNameFor(model => model.Cupo)</dt>
            <dd>@Model.Cupo</dd>
            <dt>@Html.DisplayNameFor(model => model.Fecha)</dt>
            <dd>@Model.Fecha.ToLongDateString()</dd>
            <dt>@Html.DisplayNameFor(model => model.Establecimiento.Nombre)</dt>
            <dd>@Model.Establecimiento.Nombre</dd>
            <dt>@Html.DisplayNameFor(model => model.Establecimiento.Direccion.Descripcion)</dt>
            <dd>@Model.Establecimiento.Direccion.Descripcion</dd>
            <dt>@Html.DisplayNameFor(model => model.Establecimiento.Direccion.Ubicacion)</dt>
            <dd>@Model.Establecimiento.Direccion.Ubicacion</dd>
            <dt>@Html.DisplayNameFor(model => model.EstaEliminado)</dt>
            <dd>@Model.EstaEliminado</dd>
            <br />
            <dt>Actividades</dt>
            @if (!Model.Actividades.Where(a=>a.EstaEliminado.Equals("No")).ToList().Any())
            {
                <dd>No tiene actividades asignadas por el momento.</dd>
            }
            else
            {
                <dd> </dd>
            }
            <div style="margin-left: 100px;">
                @foreach (var actividad in Model.Actividades)
                {
                    if (actividad.EstaEliminado.Equals("No"))
                    {
                        <dt>Nombre</dt>
                        <dd>@actividad.Nombre</dd>
                        <dt>Fecha y Hora</dt>
                        <dd>@actividad.FechaHora.ToString("f")</dd>
                        <dt>Sala</dt>
                        <dd>@actividad.Sala.Nombre</dd>
                        <dt>Disertante</dt>
                        <dd>@actividad.Disertante.Nombre</dd>
                        <dt></dt>
                        <dd><a asp-controller="Actividad" asp-action="Delete" asp-route-id="@actividad.Id" asp-route-eventoId="@Model.Id" class="btn btn-sm btn-danger"><span class="glyphicon glyphicon-trash"></span></a></dd>   
                    }
                }
            </div>
            <br />

        </dl>
    </div>
</div>

<div>
    <a class="btn btn-default" asp-action="Index" asp-route-empresaId="@ViewBag.EmpresaId"><span class="glyphicon glyphicon-menu-left"></span>Volver a la lista</a>
    @if (Model.Fecha.Date > DateTime.Now.Date)
    {
        @if (User.IsInRole("Admin"))
        {
            <a class="btn btn-primary" asp-action="Edit" asp-route-id="@Model.Id" asp-route-vbEmpresa="@ViewBag.EmpresaId"><span class="glyphicon glyphicon-pencil"></span></a>
        }
        <a class="btn btn-primary" asp-controller="Actividad" asp-action="Create" asp-route-eventoId="@Model.Id" asp-route-empresaId="@Model.EmpresaId" asp-route-vbEmpresa="@ViewBag.EmpresaId" asp-route-establecimientoId="@Model.EstablecimientoId" asp-route-fecha="@Model.Fecha.Date.ToString()"><span class="glyphicon glyphicon-bullhorn"></span> Agregar Actividad</a>
        @*<a class="btn btn-primary" onclick="handleCreateModalShow(@Model.Id)"><span class="glyphicon glyphicon-bullhorn"></span> Agregar Actividad</a>*@
    }

</div>


@*<div class="modal fade" id="create-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h3 class="modal-title text-center" id="modal-title">Nueva Actividad</h3>
                </div>
                <div class="modal-body" id="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        const handleCreateModalShow = (eventoId) => {

            $("#modal-body").load("/Actividad/CreatePartial?eventoId=" + eventoId);

            $('#create-modal').modal("show");
        }
    </script>*@